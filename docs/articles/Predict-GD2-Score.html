<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Computing GD2 Scores Programmatically Using GD2Viz â€¢ GD2Viz</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computing GD2 Scores Programmatically Using GD2Viz">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GD2Viz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.01.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/GD2Viz-app.html">GD2Viz app - Explore public datasets and analyze your data</a></li>
    <li><a class="dropdown-item" href="../articles/Predict-GD2-Score.html">Computing GD2 Scores Programmatically Using GD2Viz</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/arsenij-ust/GD2Viz/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="Predict-GD2-Score_files/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="Predict-GD2-Score_files/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Computing GD2 Scores Programmatically Using GD2Viz</h1>
                        <h4 data-toc-skip class="author">Arsenij
Ustjanzew</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:arsenij.ustjanzew@gmail.com" class="email">arsenij.ustjanzew@gmail.com</a>
      
                  
            <h4 data-toc-skip class="date">21 Mai 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/arsenij-ust/GD2Viz/blob/HEAD/vignettes/Predict-GD2-Score.Rmd" class="external-link"><code>vignettes/Predict-GD2-Score.Rmd</code></a></small>
      <div class="d-none name"><code>Predict-GD2-Score.Rmd</code></div>
    </div>

    
    
<p><br><strong>Authors</strong>: Arsenij Ustjanzew [aut, cre] (<a href="https://orcid.org/0000-0000-0000-0000" class="external-link uri">https://orcid.org/0000-0000-0000-0000</a>), Claudia Paret
[aut] (<a href="https://orcid.org/0000-0000-0000-0000" class="external-link uri">https://orcid.org/0000-0000-0000-0000</a>), Federico Marini
[aut] (<a href="https://orcid.org/0000-0003-3252-7758" class="external-link uri">https://orcid.org/0000-0003-3252-7758</a>)<br><strong>Version</strong>: 0.01.1<br><strong>Compiled date</strong>:
2025-05-21<br><strong>License</strong>: MIT + file LICENSE<br></p>
<p><img src="images/GD2Viz6.png" align="center" width="150px"></p>
<hr>
<div class="section level2">
<h2 id="vignette-computing-gd2-scores-programmatically-using-gd2viz">Vignette: Computing GD2 Scores Programmatically Using GD2Viz<a class="anchor" aria-label="anchor" href="#vignette-computing-gd2-scores-programmatically-using-gd2viz"></a>
</h2>
<p>This vignette demonstrates how to use the <strong>GD2Viz</strong> R
package to compute Reaction Activity Scores and predict GD2 Scores for
the GSE147635 dataset, which includes neuroblastoma (NB) and
ganglioneuroma (GN) samples. This workflow uses pre-trained models and
pathway graphs from the GD2Viz package and walks through the process
step by step using base R and Bioconductor conventions.</p>
<div class="section level3">
<h3 id="load-required-libraries">1. Load Required Libraries<a class="anchor" aria-label="anchor" href="#load-required-libraries"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/thelovelab/DESeq2" class="external-link">DESeq2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/arsenij-ust/GD2Viz" class="external-link">GD2Viz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/AnnotationDbi" class="external-link">AnnotationDbi</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">kernlab</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-training-data-and-metabolic-graph">2. Load Training Data and Metabolic Graph<a class="anchor" aria-label="anchor" href="#load-training-data-and-metabolic-graph"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">train.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"train_data.Rds"</span>, package <span class="op">=</span> <span class="st">"GD2Viz"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mgraph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"substrate_graph.Rds"</span>, package <span class="op">=</span> <span class="st">"GD2Viz"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>These are precomputed resources required by <code>GD2Viz</code> for
RAS computation and model training.</p>
<hr>
</div>
<div class="section level3">
<h3 id="load-and-prepare-the-gse147635-dataset">3. Load and Prepare the GSE147635 Dataset<a class="anchor" aria-label="anchor" href="#load-and-prepare-the-gse147635-dataset"></a>
</h3>
<div class="section level4">
<h4 id="read-raw-count-files">3.1 Read Raw Count Files<a class="anchor" aria-label="anchor" href="#read-raw-count-files"></a>
</h4>
<p>In this setup the count files (.tsv) per sample are located in
<code>data/GSE147635-counts</code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts_dir</span> <span class="op">&lt;-</span> <span class="st">"./data/GSE147635-counts"</span></span>
<span><span class="va">count_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">counts_dir</span><span class="op">)</span></span>
<span></span>
<span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">counts_dir</span>, <span class="va">count_files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">file_path</span>, header <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowname"</span>, <span class="va">count_files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">file</span> <span class="kw">in</span> <span class="va">count_files</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">counts_dir</span>, <span class="va">file</span><span class="op">)</span></span>
<span>  <span class="va">temp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">file_path</span>, header <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">temp_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowname"</span>, <span class="va">file</span><span class="op">)</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">temp_df</span><span class="op">[</span>, <span class="va">file</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="construct-count-matrix-metadata-and-annotation">3.2 Construct Count Matrix, Metadata, and Annotation<a class="anchor" aria-label="anchor" href="#construct-count-matrix-metadata-and-annotation"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">rowname</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_count.tsv"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove cell line samples</span></span>
<span><span class="va">NB_CL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR11434496"</span>, <span class="st">"SRR11434497"</span>, <span class="st">"SRR11434498"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">NB_CL</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Metadata</span></span>
<span><span class="va">coldata_NB_GN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"GN"</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"NB"</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">coldata_NB_GN</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Annotation using ENSEMBL -&gt; SYMBOL and ENTREZ</span></span>
<span><span class="va">ensemblIDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\..*"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">geneSymbol</span> <span class="op">&lt;-</span> <span class="fu">AnnotationDbi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">mapIds</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span>, keys <span class="op">=</span> <span class="va">ensemblIDs</span>, keytype <span class="op">=</span> <span class="st">"ENSEMBL"</span>, column <span class="op">=</span> <span class="st">"SYMBOL"</span><span class="op">)</span></span>
<span><span class="va">entrezIDs</span> <span class="op">&lt;-</span> <span class="fu">AnnotationDbi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">mapIds</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span>, keys <span class="op">=</span> <span class="va">ensemblIDs</span>, keytype <span class="op">=</span> <span class="st">"ENSEMBL"</span>, column <span class="op">=</span> <span class="st">"ENTREZID"</span><span class="op">)</span></span>
<span><span class="va">rowdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ensemblIDs <span class="op">=</span> <span class="va">ensemblIDs</span>, geneSymbol <span class="op">=</span> <span class="va">geneSymbol</span>, entrezIDs <span class="op">=</span> <span class="va">entrezIDs</span>, row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-a-deseqdataset">3.3 Create a DESeqDataSet<a class="anchor" aria-label="anchor" href="#create-a-deseqdataset"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NB_GN_dds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html" class="external-link">DESeqDataSetFromMatrix</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">coldata_NB_GN</span>, design <span class="op">=</span> <span class="op">~</span><span class="va">type</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">NB_GN_dds</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">rowdata</span></span>
<span></span>
<span><span class="co"># Keep only genes with valid symbols and remove duplicates</span></span>
<span><span class="va">NB_GN_dds</span> <span class="op">&lt;-</span> <span class="va">NB_GN_dds</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">NB_GN_dds</span><span class="op">)</span><span class="op">$</span><span class="va">geneSymbol</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">NB_GN_dds</span> <span class="op">&lt;-</span> <span class="va">NB_GN_dds</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">NB_GN_dds</span><span class="op">)</span><span class="op">$</span><span class="va">geneSymbol</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">NB_GN_dds</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">NB_GN_dds</span><span class="op">)</span><span class="op">$</span><span class="va">geneSymbol</span></span></code></pre></div>
<pre><code># inspect dds object
&gt; NB_GN_dds
class: DESeqDataSet 
dim: 60603 21 
metadata(1): version
assays(1): counts
rownames(60603): ENSG00000000003.14 ENSG00000000005.6 ... ENSG00000288110.1 ENSG00000288111.1
rowData names(3): ensemblIDs geneSymbol entrezIDs
colnames(21): SRR11434490 SRR11434491 ... SRR11434512 SRR11434513
colData names(1): type</code></pre>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="compute-reaction-activity-scores-ras">4. Compute Reaction Activity Scores (RAS)<a class="anchor" aria-label="anchor" href="#compute-reaction-activity-scores-ras"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeReactionActivityScores.html">computeReactionActivityScores</a></span><span class="op">(</span>dds <span class="op">=</span> <span class="va">NB_GN_dds</span>, mgraph <span class="op">=</span> <span class="va">mgraph</span>, geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html" class="external-link">metadata</a></span><span class="op">(</span><span class="va">train.data</span><span class="op">)</span><span class="op">$</span><span class="va">geom</span><span class="op">)</span></span></code></pre></div>
<p>This computes unadjusted and adjusted RAS matrices (<code>ras</code>,
<code>ras_prob</code>, and <code>ras_prob_rec</code>) using the
glycosphingolipid pathway structure.</p>
<hr>
</div>
<div class="section level3">
<h3 id="train-gd2-models">5. Train GD2 Models<a class="anchor" aria-label="anchor" href="#train-gd2-models"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kernfit.ras</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trainGD2model.html">trainGD2model</a></span><span class="op">(</span><span class="va">train.data</span>, adjust_ras <span class="op">=</span> <span class="st">"ras"</span>, adjust_input <span class="op">=</span> <span class="st">"raw"</span>, type_column <span class="op">=</span> <span class="st">"X_study"</span><span class="op">)</span></span>
<span><span class="va">kernfit.ras_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trainGD2model.html">trainGD2model</a></span><span class="op">(</span><span class="va">train.data</span>, adjust_ras <span class="op">=</span> <span class="st">"ras_prob"</span>, adjust_input <span class="op">=</span> <span class="st">"raw"</span>, type_column <span class="op">=</span> <span class="st">"X_study"</span><span class="op">)</span></span>
<span><span class="va">kernfit.ras_prob_rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trainGD2model.html">trainGD2model</a></span><span class="op">(</span><span class="va">train.data</span>, adjust_ras <span class="op">=</span> <span class="st">"ras_prob_rec"</span>, adjust_input <span class="op">=</span> <span class="st">"raw"</span>, type_column <span class="op">=</span> <span class="st">"X_study"</span><span class="op">)</span></span></code></pre></div>
<p>Each model corresponds to a different RAS adjustment strategy, but
all are trained on raw input.</p>
<pre><code># inspect object
&gt; kernfit.ras
Support Vector Machine object of class "ksvm" 

SV type: C-svc  (classification) 
 parameter : cost C = 1 

Linear (vanilla) kernel function. 

Number of Support Vectors : 159 

Objective Function Value : -142.1803 
Training error : 0.006227 
</code></pre>
<hr>
</div>
<div class="section level3">
<h3 id="predict-gd2-scores">6. Predict GD2 Scores<a class="anchor" aria-label="anchor" href="#predict-gd2-scores"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GD2res.ras</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeGD2Score.html">computeGD2Score</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ras</span>, <span class="va">kernfit.ras</span>, adjust_input <span class="op">=</span> <span class="st">"raw"</span>, range_output <span class="op">=</span> <span class="cn">FALSE</span>, center <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">GD2res.ras_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeGD2Score.html">computeGD2Score</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ras_prob</span>, <span class="va">kernfit.ras_prob</span>, adjust_input <span class="op">=</span> <span class="st">"raw"</span>, range_output <span class="op">=</span> <span class="cn">FALSE</span>, center <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">GD2res.ras_prob_rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeGD2Score.html">computeGD2Score</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ras_prob_rec</span>, <span class="va">kernfit.ras_prob_rec</span>, adjust_input <span class="op">=</span> <span class="st">"raw"</span>, range_output <span class="op">=</span> <span class="cn">FALSE</span>, center <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Each <code>GD2res</code> object contains predicted GD2 scores for
your dataset based on the corresponding RAS matrix.</p>
<ul>
<li>
<code>GD2res.ras$preds</code> contains the predicted GD2 score per
sample.</li>
<li>
<code>GD2res.ras$input_df</code> contains the sum of RAS of GD2
promoting (x) and GD2 mitigating (y) reactions.</li>
</ul>
<pre><code># inspect output
&gt; GD2res.ras
$preds
SRR11434490 SRR11434491 SRR11434492 SRR11434493 SRR11434494 SRR11434495 SRR11434499 SRR11434500 SRR11434501 SRR11434502 SRR11434503 SRR11434504 SRR11434505 SRR11434506 
-3.15969556 -3.80965863 -3.26173346 -2.31618710 -3.01514854 -1.84682457  1.90205071  0.02774619 -1.26444071  3.32799785  3.61805815  2.71453233  0.41832016 -1.70589323 
SRR11434507 SRR11434508 SRR11434509 SRR11434510 SRR11434511 SRR11434512 SRR11434513 
 0.39124098  0.35011671  0.42324510 -1.84380660  0.64591858 -0.63152673 -1.46629172 

$input_df
                   x         y
SRR11434490 5.304108 11.917678
SRR11434491 4.740051 10.970778
SRR11434492 5.009035 11.282669
SRR11434493 5.330185 11.484064
SRR11434494 5.079104 11.302970
SRR11434495 5.114256 10.700104
SRR11434499 5.764573 10.031501
SRR11434500 5.627962 10.809748
SRR11434501 5.511242 11.293214
SRR11434502 5.970077  9.678619
SRR11434503 6.142886  9.915355
SRR11434504 5.981041 10.064461
SRR11434505 5.808792 11.006384
SRR11434506 5.442241 11.389793
SRR11434507 6.017730 11.514321
SRR11434508 5.844057 11.129459
SRR11434509 5.531588 10.350686
SRR11434510 5.654024 11.969471
SRR11434511 5.778696 10.801939
SRR11434512 5.593311 11.115050
SRR11434513 5.758643 11.994297</code></pre>
<hr>
</div>
<div class="section level3">
<h3 id="visualize-gd2-scores">7. Visualize GD2 Scores<a class="anchor" aria-label="anchor" href="#visualize-gd2-scores"></a>
</h3>
<div class="section level4">
<h4 id="grouped-boxplot-by-sample-type">Grouped Boxplot by Sample Type<a class="anchor" aria-label="anchor" href="#grouped-boxplot-by-sample-type"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">GD2res.ras_prob</span><span class="op">$</span><span class="va">preds</span><span class="op">)</span>,</span>
<span>  GD2_score <span class="op">=</span> <span class="va">GD2res.ras_prob</span><span class="op">$</span><span class="va">preds</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">NB_GN_dds</span><span class="op">)</span><span class="op">$</span><span class="va">type</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_plot</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">GD2_score</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Predicted GD2 Score"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Sample Group"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"GD2 Score"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/GD2Score_plot.png" align="center" width="50%"></p>
<p>This plot helps distinguish GD2-high and GD2-low phenotypes between
NB and GN groups, and can inform potential downstream DEA or biomarker
analysis.</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>This vignette demonstrated how to:</p>
<ul>
<li>Preprocess RNA-seq count data from GSE147635</li>
<li>Annotate and format data into a <code>DESeqDataSet</code>
</li>
<li>Compute Reaction Activity Scores using a metabolic graph</li>
<li>Train and apply GD2 prediction models</li>
<li>Visualize predicted GD2 scores by sample group</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Arsenij Ustjanzew, Claudia Paret, Federico Marini.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
